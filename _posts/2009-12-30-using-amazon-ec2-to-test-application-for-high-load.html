---
layout: post
title: Using Amazon EC2 to test application for high load
tags:
- Testing
status: draft
type: post
published: false
meta:
  _edit_last: '1'
---
In this post i want to share my experience with using Amazon EC2 to load test an application. This is a cost efficient way to get an approximation of what size rig one needs to support a high number of users.

There are several advantages to using EC2 for testing:
<ul>
	<li>low cost: pay for what you use.</li>
	<li>immediate availablility: virtually unlimited resources available now.</li>
	<li>full control: you are root.</li>
	<li>reuseability: set up an instance, make an image and start another box with the same configuration.</li>
	<li>Don't pay for idle resources: set up your test rigs/server park, perform testing, take things down, get some sleep, reboot instances and continue testing. Once things are set up it is easy to take things down and boot it up again some other time.</li>
</ul>
So, that's the pitch.. here's the good stuff. Let me start by describing the architecture i want to test. The application I'm testing is a twitter clone. Just a simple microblog, where many users will post content and read content. It will consist of a JBoss Seam web application running on a JBoss AS with MySQL as Database backend. We'll be using Apache HTTP with mod_proxy as a LB (I want to test out JBoss Cloud with mod_cluster at a later time, but this will do for now). Behind the proxy LB, well have 4 JBoss AS to serve the web app dynamic content, and we'll be using a simple MySQL multiple-master replication between two MySQL instances to prevent a SPOF(single point of failure).

Here's a cheesy diagram to depict the madness:

<a href="http://www.glxn.net/wp-content/uploads/2009/12/architecture1.gif"><img class="size-full wp-image-82 alignleft" title="architecture" src="http://www.glxn.net/wp-content/uploads/2009/12/architecture1.gif" alt="architecture" width="595" height="445" /></a>

To run the tests I'll be using three EC2 instances running JMeter to get a significant load.
